#!/bin/bash
echo "ğŸš€ ä¸€é”®ç½‘ç»œæµ‹é€Ÿ"

# æ–¹æ³•1: ä½¿ç”¨ ping æµ‹è¯•å»¶è¿Ÿ
echo "ğŸ”„ æµ‹è¯•ç½‘ç»œå»¶è¿Ÿ..."
ping -c 5 8.8.8.8 | grep "min/avg/max" | awk -F'/' '{print "ç½‘ç»œå»¶è¿Ÿ: " $4 " ms"}'

# æ–¹æ³•2: ä½¿ç”¨ wget æµ‹è¯•ä¸‹è½½é€Ÿåº¦
echo "â¬‡ï¸ æµ‹è¯•ä¸‹è½½é€Ÿåº¦..."
start_time=$(date +%s)
wget -O /dev/null --timeout=10 http://cachefly.cachefly.net/100mb.test 2>&1 | grep "MB/s" | awk '{print "ä¸‹è½½é€Ÿåº¦: " $3 " " $4}'
end_time=$(date +%s)

# å¦‚æœä¸Šé¢çš„æ–¹æ³•å¤±è´¥ï¼Œä½¿ç”¨å¤‡ç”¨æ–¹æ³•
if [ $? -ne 0 ]; then
    echo "ğŸ“Š ä½¿ç”¨å¤‡ç”¨æµ‹é€Ÿæ–¹æ³•..."
    speed=$(curl -s -w "%{speed_download}" -o /dev/null http://cachefly.cachefly.net/100mb.test)
    echo "ä¸‹è½½é€Ÿåº¦: $(echo "scale=2; $speed / 1024 / 1024" | bc) MB/s"
fi

echo "âœ… æµ‹é€Ÿå®Œæˆ"

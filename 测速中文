#!/bin/bash
echo "ğŸš€ ä¸€é”®ç½‘ç»œæµ‹é€Ÿ"

# æ£€æŸ¥å¹¶å®‰è£…å¿…è¦å·¥å…·
if ! command -v bc &> /dev/null; then
    echo "å®‰è£…å¿…è¦å·¥å…·..."
    apt-get update > /dev/null 2>&1 && apt-get install -y bc > /dev/null 2>&1
fi

# å»¶è¿Ÿæµ‹è¯• - 10æ¬¡pingå–å¹³å‡å€¼
echo "ğŸ”„ æµ‹è¯•ç½‘ç»œå»¶è¿Ÿ..."
ping_result=$(ping -c 10 8.8.8.8 | tail -1)
if echo "$ping_result" | grep -q "/"; then
    avg_ping=$(echo "$ping_result" | awk -F'/' '{print $5}')
    echo "ç½‘ç»œå»¶è¿Ÿ: $avg_ping ms"
else
    echo "ç½‘ç»œå»¶è¿Ÿ: æµ‹è¯•å¤±è´¥"
fi

# ä¸‹è½½é€Ÿåº¦æµ‹è¯• - ä½¿ç”¨ wget æ˜¾ç¤ºå®æ—¶é€Ÿåº¦
echo "â¬‡ï¸ æµ‹è¯•ä¸‹è½½é€Ÿåº¦ï¼ˆ10ç§’ï¼‰..."
echo "æ­£åœ¨ä¸‹è½½æµ‹è¯•æ–‡ä»¶..."

# ä½¿ç”¨ wget å¹¶æ˜¾ç¤ºè¿›åº¦ï¼ˆä¼šè‡ªåŠ¨æ˜¾ç¤ºé€Ÿåº¦ï¼‰
wget -O /dev/null --progress=dot:giga --timeout=15 http://cachefly.cachefly.net/100mb.test 2>&1 | grep --line-buffered -oP '\d+\.\d+ [KM]B/s' | tail -1 | awk '{print "å¹³å‡ä¸‹è½½é€Ÿåº¦: " $1 " " $2}'

echo "âœ… æµ‹é€Ÿå®Œæˆ"

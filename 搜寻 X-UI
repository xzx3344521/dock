cat << 'EOF' > deep_search_xui.sh
#!/bin/bash

echo "========================================================"
echo "   æ­£åœ¨è¿›è¡Œ Debian 12 æ·±åº¦åœ°æ¯¯å¼æœç´¢ (X-UI/Xray)"
echo "========================================================"

# 1. ğŸ•µï¸â€â™‚ï¸ ä¾¦æ¢æ¨¡å¼ï¼šæŸ¥æ“ä½œå†å² (æœ€å¯èƒ½æ‰¾åˆ°çº¿ç´¢çš„åœ°æ–¹)
echo -e "\n[1/4] æ­£åœ¨åˆ†æå‘½ä»¤å†å² (.bash_history)..."
HISTORY_MATCH=$(grep -E "wget|curl" ~/.bash_history | grep "x-ui" | tail -n 5)
if [ -n "$HISTORY_MATCH" ]; then
    echo -e "\033[0;32må‘ç°æ›¾ç»æ‰§è¡Œè¿‡çš„ä¸‹è½½å‘½ä»¤ï¼š\033[0m"
    echo "$HISTORY_MATCH"
    echo -e "ğŸ‘† (å¦‚æœä¸Šé¢æ˜¯ curl | bash æ ¼å¼ï¼Œè¯´æ˜æ²¡ä¿å­˜å®‰è£…åŒ…ï¼Œæ˜¯ç›´æ¥è¿è¡Œçš„)"
else
    echo "å†å²è®°å½•ä¸­æœªå‘ç°æ˜æ˜¾çš„ä¸‹è½½å‘½ä»¤ã€‚"
fi

# 2. ğŸ“‚ å…¨ç›˜æœç´¢ï¼šä¸æ”¾è¿‡ä»»ä½•è§’è½ (æ’é™¤ç³»ç»Ÿè™šæ‹Ÿç›®å½•)
echo -e "\n[2/4] æ­£åœ¨å…¨ç›˜æœç´¢æ–‡ä»¶ååŒ…å« 'x-ui' çš„æ–‡ä»¶ (å¯èƒ½éœ€è¦ä¸€ç‚¹æ—¶é—´)..."
# æ’é™¤ /proc, /sys, /run, /dev é¿å…æŠ¥é”™
find / -path /proc -prune -o -path /sys -prune -o -path /run -prune -o -path /dev -prune -o -type f -name "*x-ui*" -print 2>/dev/null | grep -vE "(/usr/local/x-ui|/var/lib/docker)" | head -n 20
# (grep -v æ˜¯ä¸ºäº†å±è”½æ‰å·²ç»å®‰è£…å¥½çš„ç¨‹åºæ–‡ä»¶ï¼Œåªæ‰¾å®‰è£…åŒ…)

# 3. ğŸ“ å†…å®¹æœç´¢ï¼šæŸ¥æ‰¾åå­—æ˜¯ install.sh ä½†å†…å®¹æ˜¯ X-UI çš„æ–‡ä»¶
echo -e "\n[3/4] æ­£åœ¨æ£€æŸ¥å¸¸è§çš„ install.sh è„šæœ¬å†…å®¹..."
# æœç´¢ /root å’Œ /home ä¸‹æ‰€æœ‰çš„ .sh æ–‡ä»¶
find /root /home /tmp -maxdepth 3 -name "*.sh" -type f 2>/dev/null | while read -r script; do
    if grep -q "x-ui" "$script"; then
        echo -e "\033[0;33mç–‘ä¼¼ç›®æ ‡è„šæœ¬ (å†…å®¹åŒ…å« x-ui): $script\033[0m"
    fi
done

# 4. ğŸ“¦ å¤§æ–‡ä»¶æœç´¢ï¼šæŸ¥æ‰¾å¯èƒ½æ˜¯å‹ç¼©åŒ…çš„æ®‹ç•™
echo -e "\n[4/4] æ­£åœ¨æœç´¢æœ€è¿‘ä¿®æ”¹è¿‡çš„å‹ç¼©åŒ… (tar.gz/zip)..."
find /root /home /tmp -type f \( -name "*.tar.gz" -o -name "*.zip" \) -mtime -365 -size +1M 2>/dev/null | head -n 10

echo -e "\n========================================================"
echo "æœç´¢ç»“æŸã€‚"
EOF

chmod +x deep_search_xui.sh && ./deep_search_xui.sh

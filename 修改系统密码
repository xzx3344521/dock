#!/bin/bash

# 修改系统密码脚本
# 使用方法: sudo ./change_password.sh [用户名]

set -e

# 新密码
NEW_PASSWORD="Xzc3459635287"

# 检查是否以root权限运行
if [ "$EUID" -ne 0 ]; then
    echo "错误: 请使用 sudo 运行此脚本"
    echo "用法: sudo $0 [用户名]"
    exit 1
fi

# 获取要修改的用户名（默认为当前用户）
USERNAME=${1:-$USER}

# 检查用户是否存在
if ! id "$USERNAME" &>/dev/null; then
    echo "错误: 用户 '$USERNAME' 不存在"
    exit 1
fi

echo "正在修改用户 '$USERNAME' 的密码..."
echo "新密码: $NEW_PASSWORD"

# 使用 chpasswd 修改密码
echo "$USERNAME:$NEW_PASSWORD" | chpasswd

if [ $? -eq 0 ]; then
    echo "✅ 密码修改成功！"
    echo "用户名: $USERNAME"
    echo "新密码: $NEW_PASSWORD"
else
    echo "❌ 密码修改失败"
    exit 1
fi

cat > /boot/docker-compose.yml << 'EOF'
version: '3.8'

services:
  intellissh:
    image: clusterzx/intellissh:latest
    container_name: intellissh
    ports:
      - "3000"  # 只暴露容器端口，主机端口随机
    volumes:
      - ./intellissh-data:/app/server/data
    environment:
      - TZ=Asia/Shanghai
    restart: unless-stopped
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

EOF

# 清理之前的失败容器
docker rm -f intellissh 2>/dev/null || true

# 重新启动
mkdir -p ./intellissh-data && docker compose -f /boot/docker-compose.yml up -d

# 查看实际映射的端口
docker port intellissh
